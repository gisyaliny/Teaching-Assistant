concord <- foreign::read.spss("Concord1.sav ", to.data.frame= TRUE)
concord <- foreign::read.spss("Concord1.sav ", to.data.frame= TRUE)
lm1<- lm(water81 ~ income + water80 + educat, data = concord)
summary(lm1)
lm2 <- lm(water81~income+water80, data=concord)
summary(lm2)
lm3 <- lm(educat~income+water80, data=concord)
summary(lm3)
library(car)
scatterplot(resid(lm2)~resid(lm3), xlab="Education Residuals",
ylab="Water Residuals", main="Partial Regression Leverage Scatterplot",
pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"),
regLine=list(col="green"))
lm4 <- lm(resid(lm2)~resid(lm3))
summary(lm4)
provItaly <- foreign::read.dbf("provinces.dbf")
car::scatterplotMatrix(~TOTFERTRAT+ILLITERRAT+FEMMARAGE+DIVORCERAT+TELEPERFAM, data=provItaly,
main="Relationship between total fertility rate and a set of exogenous variables",
pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"),
regLine=list(col="green"))
lm1<- lm(TOTFERTRAT~ ILLITERRAT+ FEMMARAGE+ DIVORCERAT+ TELEPERFAM, data=provItaly)
summary(lm1)
prov <- foreign::read.dbf("provinces.dbf")
prov <- prov[,13:17]
prov <- as.data.frame(scale(prov))
beta.lm <- lm(TOTFERTRAT~., data=prov)
summary(beta.lm)
coefplot::coefplot(beta.lm, sort="magnitude", intercept=F)
lm2 <-lm(cbind(TOTFERTRAT,ILLITERRAT,FEMMARAGE,DIVORCERAT,TELEPERFAM)~REGION,data=provItaly)
summary(lm2)
lm3 <- lm(TOTFERTRAT~FEMMARAGE+DIVORCERAT+ILLITERRAT+TELEPERFAM+REGION,data=provItaly)
summary(lm3)
anova(lm3, lm1)
load('ModelSpecs.Rdata')
summary_model <- function(mod){
full.model <- lm(y~g*x, data=mod)
Intercept.model <- lm(y~g+x, data=mod)
slope.model <- lm(y~g:x, data=mod)
means.model <- lm(y~g,data=mod)
plain.model <- lm(y~x, data=mod)
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
r_square_lst <- function(a) {return(a$adj.r.squared)}
model_summary[[6]] <- as.data.frame(lapply(model_summary, r_square_lst),
col.names = c('full.model', 'Intercept.model','slope.model','means.model','plain.model'))
model_summary[[7]] <- model_lst
return(model_summary)
}
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod1,main="Model_1")
(mod1_summary <- summary_model(mod1))[[1]]
provItaly <- foreign::read.dbf("provinces.dbf")
car::scatterplotMatrix(~TOTFERTRAT+ILLITERRAT+FEMMARAGE+DIVORCERAT+TELEPERFAM, data=provItaly,
main="Relationship between total fertility rate and a set of exogenous variables",
pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"),
regLine=list(col="green"))
load('ModelSpecs.Rdata')
summary_model <- function(mod){
full.model <- lm(y~g*x, data=mod)
Intercept.model <- lm(y~g+x, data=mod)
slope.model <- lm(y~g:x, data=mod)
means.model <- lm(y~g,data=mod)
plain.model <- lm(y~x, data=mod)
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
r_square_lst <- function(a) {return(a$adj.r.squared)}
model_summary[[6]] <- as.data.frame(lapply(model_summary, r_square_lst),
col.names = c('full.model', 'Intercept.model','slope.model','means.model','plain.model'))
model_summary[[7]] <- model_lst
return(model_summary)
}
getwd()
load('ModelSpecs.Rdata')
summary_model <- function(mod){
full.model <- lm(y~g*x, data=mod)
Intercept.model <- lm(y~g+x, data=mod)
slope.model <- lm(y~g:x, data=mod)
means.model <- lm(y~g,data=mod)
plain.model <- lm(y~x, data=mod)
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
r_square_lst <- function(a) {return(a$adj.r.squared)}
model_summary[[6]] <- as.data.frame(lapply(model_summary, r_square_lst),
col.names = c('full.model', 'Intercept.model','slope.model','means.model','plain.model'))
model_summary[[7]] <- model_lst
return(model_summary)
}
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod1,main="Model_1")
(mod1_summary <- summary_model(mod1))[[1]]
(mod1_summary <- summary_model(mod1))[[1:5]]
(mod1_summary <- summary_model(mod1))[[1:4]]
(mod1_summary <- summary_model(mod1))[[1]]
(mod1_summary <- summary_model(mod1))[[2]]
(mod1_summary <- summary_model(mod1))[[1]]
(mod1_summary <- summary_model(mod1))[[1]]
(mod1_summary <- summary_model(mod1))[[2]]
(mod1_summary <- summary_model(mod1))[[3]]
(mod1_summary <- summary_model(mod1))[[4]]
(mod1_summary <- summary_model(mod1))[[5]]
(mod1_summary <- summary_model(mod2))[[5]]
(mod1_summary <- summary_model(mod2))[[1]]
(mod1_summary <- summary_model(mod2))[[2]]
(mod1_summary <- summary_model(mod2))[[3]]
(mod1_summary <- summary_model(mod2))[[4]]
(mod1_summary <- summary_model(mod3))[[4]]
(mod1_summary <- summary_model(mod3))[[5]]
(mod1_summary <- summary_model(mod3))[[1]]
(mod1_summary <- summary_model(mod3))[[2]]
(mod1_summary <- summary_model(mod3))[[3]]
(mod1_summary <- summary_model(mod4))[[5]]
(mod1_summary <- summary_model(mod4))[[4]]
(mod1_summary <- summary_model(mod4))[[3]]
(mod1_summary <- summary_model(mod4))[[2]]
(mod1_summary <- summary_model(mod4))[[1]]
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod5,main="Model5")
(mod1_summary <- summary_model(mod5))[[1]]
(mod1_summary <- summary_model(mod5))[[2]]
(mod1_summary <- summary_model(mod5))[[3]]
(mod1_summary <- summary_model(mod5))[[4]]
(mod1_summary <- summary_model(mod5))[[5]]
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod6,main="Model6")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod4,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod5,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod6,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod5,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod6,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod1,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod2,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod3,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod4,main="Model4")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod4,main="Model4")
(mod1_summary <- summary_model(mod4))[[5]]
(mod1_summary <- summary_model(mod5))[[5]]
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod6,main="Model6")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod6,main="Model6")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod5,main="Model5")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod6,main="Model6")
(mod1_summary <- summary_model(mod6))[[5]]
(mod1_summary <- summary_model(mod6))[[4]]
(mod1_summary <- summary_model(mod6))[[3]]
(mod1_summary <- summary_model(mod6))[[2]]
(mod1_summary <- summary_model(mod6))[[1]]
