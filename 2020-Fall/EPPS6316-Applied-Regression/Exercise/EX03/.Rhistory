state_school <- foreign::read.spss('StateSchool.sav')
state_school <- foreign::read.spss('StateSchool.sav',to.data.frame = TRUE)
source('G:/UTD_Classes/2019Fall/TA/GISC_6301_GIS_Data_Analysis/Lectures/Chapter4/StateSchool.R')
setwd("~/")
setwd("G:/UTD_Classes/2019Fall/TA/GISC_6301_GIS_Data_Analysis/Lectures/Chapter4")
source('G:/UTD_Classes/2019Fall/TA/GISC_6301_GIS_Data_Analysis/Lectures/Chapter4/StateSchool.R')
source('G:/UTD_Classes/2019Fall/TA/GISC_6301_GIS_Data_Analysis/Lectures/Chapter4/StateSchool.R')
source('G:/UTD_Classes/2019Fall/TA/GISC_6301_GIS_Data_Analysis/Lectures/Chapter4/StateSchool.R')
setwd("G:/UTD_Classes/2020Fall/EPPS6316-Applied-Regression/Exercise/EX03")
provItaly <- foreign::read.dbf("provinces.dbf")
car::scatterplotMatrix(~TOTFERTRAT+ILLITERRAT+FEMMARAGE+DIVORCERAT+TELEPERFAM, data=provItaly, main="Relationship between total fertility rate and a set of exogenous variables", pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
provItaly <- foreign::read.dbf("provinces.dbf")
car::scatterplotMatrix(~TOTFERTRAT+ILLITERRAT+FEMMARAGE+DIVORCERAT+TELEPERFAM, data=provItaly, main="Relationship between total fertility rate and a set of exogenous variables", pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
provItaly <- foreign::read.dbf("provinces.dbf")
car::scatterplotMatrix(~TOTFERTRAT+ILLITERRAT+FEMMARAGE+DIVORCERAT+TELEPERFAM, data=provItaly, main="Relationship between total fertility rate and a set of exogenous variables", pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
boxplot(TOTFERTRAT~ REGION)
boxplot(TOTFERTRAT~ REGION,data = provItaly)
?boxplot
boxplot(TOTFERTRAT~ REGION,data = provItaly,horizontal = TRUE)
?boxplot
lm1<- lm(TOTFERTRAT~ ILLITERRAT+ FEMMARAGE+ DIVORCERAT+ TELEPERFAM, data=Province)
lm1<- lm(TOTFERTRAT~ ILLITERRAT+ FEMMARAGE+ DIVORCERAT+ TELEPERFAM, data=provItaly)
summary(lm1)
prov <- as.data.frame(scale(provItaly))
prov <- as.data.frame(scale(provItaly))
prov <- as.data.frame(scale(provItaly[,13:17]))
beta.lm <- lm(TOTFERTRAT~., data=prov)
summary(beta.lm)
coefplot::coefplot(beta.lm, sort="magnitude", intercept=F)
coef(beta.lm)
prov <- as.data.frame(scale(provItaly[,13:17]))
beta.lm <- lm(TOTFERTRAT~., data=prov)
t(coef(beta.lm))
coefplot::coefplot(beta.lm, sort="magnitude", intercept=F)
prov <- as.data.frame(scale(provItaly[,13:17]))
beta.lm <- lm(TOTFERTRAT~., data=prov)
coef(beta.lm)
coefplot::coefplot(beta.lm, sort="magnitude", intercept=F)
coef(beta.lm)
prov <- as.data.frame(scale(provItaly[,13:17]))
beta.lm <- lm(TOTFERTRAT~., data=prov)
coef(beta.lm)
coefplot::coefplot(beta.lm, sort="magnitude", intercept=F)
lm2 <- lm(TOTFERTRAT~FEMMARAGE+DIVORCERAT+ILLITERRAT+TELEPERFAM+REGION,data=provItaly)
summary(lm2)
anova(lm2, lm1)
load('DummyInteraction.RData')
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=mod1,main="Model1")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=df1,main="Model1")
car::scatterplot(y~x|g,smoother=F,boxplots="xy",data=df1,main="Model1")
View(df1)
car::scatterplot(y~x|d,smoother=F,boxplots="xy",data=df1,main="Model1")
View(lm.01)
state_school <- foreign::read.spss('StateSchool.sav',to.data.frame = TRUE)
provItaly <- foreign::read.dbf("provinces.dbf")
car::scatterplotMatrix(~TOTFERTRAT+ILLITERRAT+FEMMARAGE+DIVORCERAT+TELEPERFAM, data=provItaly, main="Relationship between total fertility rate and a set of exogenous variables", pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
boxplot(TOTFERTRAT~ REGION,data = provItaly,horizontal = TRUE)
lm1<- lm(TOTFERTRAT~ ILLITERRAT+ FEMMARAGE+ DIVORCERAT+ TELEPERFAM, data=provItaly)
summary(lm1)
prov <- as.data.frame(scale(provItaly[,13:17]))
beta.lm <- lm(TOTFERTRAT~., data=prov)
coef(beta.lm)
coefplot::coefplot(beta.lm, sort="magnitude", intercept=F)
lm2 <- lm(TOTFERTRAT~FEMMARAGE+DIVORCERAT+ILLITERRAT+TELEPERFAM+REGION,data=provItaly)
summary(lm2)
anova(lm2, lm1)
load('DummyInteraction.RData')
car::scatterplot(y~x|d,smoother=F,boxplots="xy",data=df1,main="Model1")
load('DummyInteraction.RData')
summary_model <- function(df){
full.model <- lm(y~d*x, data=df)
Intercept.model <- lm(y~d+x, data=df)
slope.model <- lm(y~d:x, data=df)
means.model <- lm(y~d,data=df)
plain.model <- lm(y~x, data=df)
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
# r_square_lst <- function(a) {return(a$adj.r.squared)}
# model_summary[[6]] <- as.data.frame(lapply(model_summary, r_square_lst),
#   col.names = c('full.model', 'Intercept.model','slope.model','means.model','plain.model'))
# model_summary[[7]] <- model_lst
return(model_summary)
}
load('DummyInteraction.RData')
summary_model <- function(df){
full.model <- lm(y~d*x, data=df)
Intercept.model <- lm(y~d+x, data=df)
slope.model <- lm(y~d:x, data=df)
means.model <- lm(y~d,data=df)
plain.model <- lm(y~x, data=df)
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
lapply(model_lst, car::scatterplot)
# r_square_lst <- function(a) {return(a$adj.r.squared)}
# model_summary[[6]] <- as.data.frame(lapply(model_summary, r_square_lst),
#   col.names = c('full.model', 'Intercept.model','slope.model','means.model','plain.model'))
# model_summary[[7]] <- model_lst
return(model_summary)
}
# car::scatterplot(y~x|d,smoother=F,boxplots="xy",data=df1,main="Model1")
summary_model(df1)
car::scatterplot(y~x|d,smoother=F,boxplots="xy",data=df1,main="Model1")
summary_model(df1)
load('DummyInteraction.RData')
summary_model <- function(df,n){
full.model <- lm(y~d*x, data=df)
car::scatterplot(y~d*x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
Intercept.model <- lm(y~d+x, data=df)
car::scatterplot(y~d+x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
slope.model <- lm(y~d:x, data=df)
car::scatterplot(y~d:x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
means.model <- lm(y~d,data=df)
car::scatterplot(y~d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
plain.model <- lm(y~x, data=df)
car::scatterplot(y~x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
return(model_summary)
}
summary_model(df1)
summary_model(df1,1)
summary_model(df1,1)
load('DummyInteraction.RData')
summary_model <- function(df,n){
full.model <- lm(y~d*x, data=df)
car::scatterplot(y~d*x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
Intercept.model <- lm(y~d+x, data=df)
car::scatterplot(y~d+x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
slope.model <- lm(y~d:x, data=df)
car::scatterplot(y~d:x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
means.model <- lm(y~d,data=df)
car::scatterplot(y~d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
plain.model <- lm(y~x, data=df)
car::scatterplot(y~x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
return(model_summary)
}
summary_model(df1,1)
car::scatterplot(y~d*x,smoother=F,boxplots="xy",data=df1,main=paste("Model",1))
car::scatterplot(y~x*d,smoother=F,boxplots="xy",data=df1,main=paste("Model",1))
load('DummyInteraction.RData')
summary_model <- function(df,n){
full.model <- lm(y~x*d, data=df)
car::scatterplot(y~x*d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
Intercept.model <- lm(y~x+d, data=df)
car::scatterplot(y~x+d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
slope.model <- lm(y~x:d, data=df)
car::scatterplot(y~x:d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
means.model <- lm(y~d,data=df)
car::scatterplot(y~d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
plain.model <- lm(y~x, data=df)
car::scatterplot(y~x,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
return(model_summary)
}
car::scatterplot(y~x*d,smoother=F,boxplots="xy",data=df1,main=paste("Model",1))
df1_summary = summary_model(df1,1)
load('DummyInteraction.RData')
summary_model <- function(df,n){
car::scatterplot(y~x|d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
full.model <- lm(y~x*d, data=df)
Intercept.model <- lm(y~x+d, data=df)
slope.model <- lm(y~x:d, data=df)
means.model <- lm(y~d,data=df)
plain.model <- lm(y~x, data=df)
model_lst <- list(full.model,Intercept.model,slope.model,means.model,plain.model)
model_summary <- lapply(model_lst, summary)
return(model_summary)
}
df1_summary = summary_model(df1,1)
df1_summary = summary_model(df1,1)
df1_summary = summary_model(df1,1)
df1_summary = summary_model(df1,1)
df1_summary
load('DummyInteraction.RData')
summary_model <- function(df,n){
car::scatterplot(y~x|d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
full.model <- lm(y~x*d, data=df)
Intercept.model <- lm(y~x+d, data=df)
slope.model <- lm(y~x:d, data=df)
means.model <- lm(y~d,data=df)
plain.model <- lm(y~x, data=df)
model_lst <- list(plain.model,means.model,Intercept.model,full.model,slope.model)
model_summary <- lapply(model_lst, summary)
return(model_summary)
}
df1_summary = summary_model(df1,1)
df1_summary
load('DummyInteraction.RData')
summary_model <- function(df,n){
car::scatterplot(y~x|d,smoother=F,boxplots="xy",data=df,main=paste("Model",n))
full.model <- lm(y~x*d, data=df)
Intercept.model <- lm(y~x+d, data=df)
slope.model <- lm(y~x:d, data=df)
means.model <- lm(y~d,data=df)
plain.model <- lm(y~x, data=df)
model_lst <- list(plain.model,means.model,Intercept.model,full.model,slope.model)
model_summary <- lapply(model_lst, summary)
return(model_summary)
}
clear
df1_summary = summary_model(df1,1)
df1_summary
df1_summary = summary_model(df1,1)
df1_summary
df_summary = summary_model(df2,2)
df_summary
df_summary = summary_model(df2,2)
df_summary
df_summary = summary_model(df3,3)
df_summary
df_summary = summary_model(df4,4)
df_summary
df_summary = summary_model(df5,5)
df_summary
state_school <- foreign::read.spss('StateSchool.sav',to.data.frame = TRUE)
car::scatterplotMatrix(~SAT+EXPEND+PCTSAT, data=state_school, main="Relationship between SAT score and a set of exogenous variables", pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
View(state_school)
View(state_school)
state_school <- foreign::read.spss('StateSchool.sav',to.data.frame = TRUE)
car::scatterplotMatrix(~SAT+Expend+PctSAT, data=state_school, main="Relationship between SAT score and a set of exogenous variables", pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
state_school <- foreign::read.spss('StateSchool.sav',to.data.frame = TRUE)
car::scatterplotMatrix(~SAT+Expend+PctSAT, data=state_school, main="Relationship between SAT score and a set of exogenous variables", pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
state_school <- foreign::read.spss('StateSchool.sav',to.data.frame = TRUE)
car::scatterplotMatrix(~SAT+Expend+PctSAT, data=state_school, main="Relationship between SAT Score and a set of exogenous variables", pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
lm1 <- lm(SAT~Expend,data = state_school)
summary(lm1)
lm2 <- lm(SAT~PctSAT,data = state_school)
summary(lm2)
lm3 <- lm(SAT~Expend+PctSAT,data = state_school)
summary(lm3)
car::scatterplot(resid(lm3)~PctSAT,main="Partial Regression Leverage Scatterplot")
car::scatterplot(resid(lm3)~PctSAT,data = state_school,main="Partial Regression Leverage Scatterplot")
car::scatterplot(resid(lm3)~PctSAT,data = state_school,main="Partial Regression Leverage Scatterplot",pch=1, smooth=list(span = 0.35,lty.smooth=1, col.smooth="red", col.var="red"), regLine=list(col="green"))
